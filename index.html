<!DOCTYPE html>
<html lang="en">

<head>
    <title>Grade 4 Math Questions</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="./css/all.min.css">

    <style>
        /* Your existing styles here */

        /* Styles for the settings toggle */
        .settings-toggle {
            position: fixed;
            top: 65px;
            right: 20px;
            background-color: #FF69B4;
            border: none;
            color: white;
            padding: 10px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: transform 0.2s ease;
        }

        .settings-toggle:hover {
            transform: scale(1.1);
        }

        .hidden {
            display: none;
        }
    </style>
    <style>
        /* Reset default margin and padding */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: black;
            color: #ffffff;
        }

h1,h2,h3 {
            text-align: center;
            margin: 20px 0;
        }

        /* Navigation Buttons */
        .nav-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            margin: 10px 0;
        }

        .nav-buttons .btn {
            margin: 5px;
            text-decoration: none;
            color: white;
        }

        /* Form Styling */
        form {
            margin: 0 auto;
            width: 90%;
            max-width: 800px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }

        .qrow {
            flex: 1 1 calc(50% - 20px);
            margin: 10px;
            padding: 10px;
            border: 1px solid #ffffff;
            border-radius: 5px;
        }

        @media screen and (max-width: 600px) {
            .qrow {
                flex: 1 1 100%;
            }
        }

        label {
            display: block;
            margin-bottom: 5px;
            color: cadetblue;
        }

        input[type="number"] {
            width: 100%;
            padding: 5px;
            margin-top: 5px;
            background-color: lightgray;
            letter-spacing: 0.15em;
            font-weight: bold;
        }

        /* Button Styling */
        .btn {
            background-color: #FF69B4;
            border: none;
            color: white;
            padding: 10px 20px;
            text-align: center;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bolder;
            margin: 10px;
            display: inline-block;
            text-decoration: none;
        }

        .btn:active {
            background-color: #a00083;
        }

        /* Centered Content */
        .center {
            margin: 0 auto;
            width: 90%;
            max-width: 800px;
        }

        /* Questions Container */
        #questions-container {
            color: white;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            /*padding-top: 10px;*/
        }

        .question {
            margin: 20px auto;
            font-size: 20px;
            letter-spacing: 0.15em;
            color: aquamarine;
            display: flex;
            flex-wrap: wrap;
            align-items: center;
        }

        .question hr {
            flex-basis: 100%;
            border: none;
            border-top: 1px solid #ffffff;
            margin-bottom: 10px;
        }

        .qlbl {
            width: 100%;
            font-size: 15px;
            color: cadetblue;
            margin-bottom: 5px;
        }

        .question input[type="tel"] {
            flex: 1;
            padding: 5px;
            margin-left: 10px;
            background-color: lightgray;
            letter-spacing: 0.15em;
            font-weight: bold;
        }

        .answer-input.answer-correct {
            border: 2px solid green;
        }

        .answer-input.answer-incorrect {
            border: 2px solid red;
        }

        .answer-message {
            padding-top: 3px;
            font-size: 14px;
        }

        .answer-message.answer-correct {
            color: green;
        }

        .answer-message.answer-incorrect {
            color: red;
        }

        /* Task List */
        .task {
            margin-bottom: 10px;
            font-size: 18px;
        }

        input[type="checkbox"] {
            margin-right: 5px;
        }

        /* Responsive Font Sizes */
        @media screen and (max-width: 600px) {
            .question {
                font-size: 16px;
            }

            .btn {
                font-size: 14px;
                padding: 8px 16px;
            }
        }
    </style>
</head>

<body>
    <!-- Navigation Buttons -->
    <div class="nav-buttons">
        <a href="./v2/index.html" class="btn">Multiplication Time Game</a>
        <a href="./v22/index.html" class="btn">Multiplication Range</a>
        <a href="./v3/index.html" class="btn">Dictation</a>
    </div>

    <h3>SmartyBoy Fundamental Math</h3>
    <button id="settings-button" class="settings-toggle">
	<i class="fa-solid fa-gear"></i>
    </button>

    <!-- Settings Form -->
    <form id="settings-form">
	<span id="settings">Setup</span>
        <div class="qrow">
            <label for="addition-digits">Addition: Maximum Digits</label>
            <input type="number" id="addition-digits" min="2" value="3">
        </div>
        <div class="qrow">
            <label for="subtraction-digits">Subtraction: Maximum Digits</label>
            <input type="number" id="subtraction-digits" min="1" value="3">
        </div>
        <div class="qrow">
            <label for="multiplication-digits">Multiplication: Maximum Digits</label>
            <input type="number" id="multiplication-digits" min="1" value="3">
        </div>
        <div class="qrow">
            <label for="division-digits">Division: Maximum Digits</label>
            <input type="number" id="division-digits" min="1" value="2">
        </div>
        <button type="submit" class="btn">Generate Questions</button>

    </form>

    <div id="content-below-reset" class="hidden">
        <div class="center">
            <div id="questions-container"></div>
            <hr>
            <button id="check-answers" type="submit" class="btn" disabled>Check Answers</button>
	    <button type="button" class="btn" onclick="resetApp()">Reset</button>
            
        </div>

<!-- 
	<h2>Daily Checklist</h2>
		<div class="task">
		<label>
		    <input type="checkbox">
		    Addition & Subtraction
		</label>
		</div>
		<div class="task">
		<label>
		    <input type="checkbox">
		    Multiplication
		</label>
		</div>
		<div class="task">
		<label>
		    <input type="checkbox">
		    Dictation
		</label>
		</div>
 -->

    </div>

    <script>
        // Settings toggle logic
        const settingsButton = document.getElementById('settings-button');
        const settingsForm = document.getElementById('settings-form');
        const contentBelowReset = document.getElementById('content-below-reset');

        settingsButton.addEventListener('click', () => {
            settingsForm.classList.toggle('hidden');
        });

        document.getElementById('settings-form').addEventListener('submit', (event) => {
            event.preventDefault();
            settingsForm.classList.add('hidden');
            contentBelowReset.classList.remove('hidden');
        });
    </script>
    <script>
        var questionNum = 1;
        document.getElementById("settings-form").addEventListener("submit", function (event) {
            event.preventDefault();

            var additionDigits = document.getElementById("addition-digits").value;
            var subtractionDigits = document.getElementById("subtraction-digits").value;
            var multiplicationDigits = document.getElementById("multiplication-digits").value;
            var divisionDigits = document.getElementById("division-digits").value;

            generateQuestions(additionDigits, subtractionDigits, multiplicationDigits, divisionDigits);

            document.getElementById("check-answers").disabled = false;
        });

        function generateQuestions(additionDigits, subtractionDigits, multiplicationDigits, divisionDigits) {
            var questionsContainer = document.getElementById("questions-container");
            questionsContainer.innerHTML = "";
            questionNum = 1; // Reset question number

            GenerateQuestionItem("Addition", additionDigits, questionsContainer, generateAdditionQuestion);
            GenerateQuestionItem("AdditionX", additionDigits, questionsContainer, generateAdditionXQuestion);
            GenerateQuestionItem("Subtraction", subtractionDigits, questionsContainer, generateSubtractionQuestion);
            GenerateQuestionItem("SubtractionX", subtractionDigits, questionsContainer, generateSubtractionXQuestion);
            GenerateQuestionItem("Multiplication1", 2, questionsContainer, generateMultiplicationQuestion);
            GenerateQuestionItem("Multiplication2", multiplicationDigits, questionsContainer, generateMultiplicationQuestion);
            GenerateQuestionItem("Multiplication3", 4, questionsContainer, generateMultiplicationQuestion);
            GenerateQuestionItem("Division1", 1, questionsContainer, generateDivisionQuestion);
            GenerateQuestionItem("Division2", divisionDigits, questionsContainer, generateDivisionQuestion);
            GenerateQuestionItem("Division3", 3, questionsContainer, generateDivisionQuestion);

            setExpired();
        }

        function GenerateQuestionItem(key, digit, questionsContainer, func) {
            var q = func(digit);
            q = fetchQuestion(key, q);
            var qElm = createQuestionElement(key, q);
            questionsContainer.appendChild(qElm);
        }

        function createQuestionElement(questionType, questionText) {
            var questionElement = document.createElement("div");
            questionElement.className = "question";

            var hrElement = document.createElement("hr");
            questionElement.appendChild(hrElement);

            var questionLabel = document.createElement("div");
            questionLabel.textContent = `${questionNum}) ${questionType}: `;
            questionLabel.className = "qlbl";
            questionElement.appendChild(questionLabel);

            questionNum++;

            var questionTextSpan = document.createElement("span");
            questionTextSpan.textContent = questionText;
            questionElement.appendChild(questionTextSpan);

            var answerInput = document.createElement("input");
            answerInput.type = "tel";
            answerInput.className = "answer-input";
            answerInput.pattern = "^-?[0-9]*$"; // Allow only numbers and minus sign
            // Validate the input
            answerInput.addEventListener("input", function () {
                if (!/^-?\d*$/.test(this.value)) {
                    this.value = this.value.slice(0, -1);
                }
            });
            questionElement.appendChild(answerInput);

            return questionElement;
        }

        function generateAdditionQuestion(digits) {
            var number1 = Math.floor(Math.random() * (Math.pow(10, digits) - 1)) + 1;
            var number2 = Math.floor(Math.random() * (Math.pow(10, digits) - 1)) + 1;
            return number1 + " + " + number2;
        }

        function generateAdditionXQuestion(digits) {
            var number1 = Math.floor(Math.random() * (Math.pow(10, digits) - 1)) + 1;
            var number2 = Math.floor(Math.random() * (Math.pow(10, digits) - 1)) + 1;
            return "__ + " + number2 + " = " + number1;
        }

        function generateSubtractionQuestion(digits) {
            var number1 = Math.floor(Math.random() * (Math.pow(10, digits) - 1)) + 1;
            var number2 = Math.floor(Math.random() * (Math.pow(10, digits) - 1)) + 1;
            return number1 + " - " + number2;
        }

        function generateSubtractionXQuestion(digits) {
            var number1 = Math.floor(Math.random() * (Math.pow(10, digits) - 1)) + 1;
            var number2 = Math.floor(Math.random() * (Math.pow(10, digits) - 1)) + 1;
            return "__ - " + number2 + " = " + number1;
        }

        function generateMultiplicationQuestion(digits) {
            var number1 = Math.floor(Math.random() * (Math.pow(10, digits) - 1)) + 1;
            var range = [2, 3, 4, 5, 10];
            var number2 = range[Math.floor(Math.random() * range.length)];
            return number1 + " × " + number2;
        }

        function generateDivisionQuestion(digits) {
            var quotient = Math.floor(Math.random() * (Math.pow(10, digits) - 1)) + 1;
            var divisors = [2, 3, 4, 5, 10];
            var divisor = divisors[Math.floor(Math.random() * divisors.length)];
            var dividend = divisor * quotient;
            return dividend + " ÷ " + divisor;
        }

        document.getElementById("check-answers").addEventListener("click", function () {
            var answerInputs = document.getElementsByClassName("answer-input");

            for (var i = 0; i < answerInputs.length; i++) {
                var answerInput = answerInputs[i];
                var questionType = answerInput.parentNode.querySelector(".qlbl").textContent;
                var question = answerInput.parentNode.querySelector("span").textContent;
                var userAnswer = parseInt(answerInput.value);
                var correctAnswer = evaluateQuestion(questionType, question);

                var answerElement = document.createElement("div");
                answerElement.classList.add("answer-message");

                if (userAnswer === correctAnswer) {
                    answerInput.classList.add("answer-correct");
                    answerElement.textContent = "Correct!";
                    answerElement.classList.add("answer-correct");
                } else {
                    answerInput.classList.add("answer-incorrect");
                    answerElement.textContent = "Incorrect! Answer is " + correctAnswer + ".";
                    answerElement.classList.add("answer-incorrect");
                }

                answerInput.after(answerElement);
            }

            // Disable the button after checking the answers
            document.getElementById("check-answers").disabled = true;
        });

        function evaluateQuestion(questionType, question) {
            var operands = question.split(/\+|\-|\×|\÷|\=/).map(function (item) {
                return parseInt(item.trim()) || 0;
            });
            var operand1 = operands[0];
            var operand2 = operands[1];
            var operand3 = operands[2] || 0;

            if (questionType.includes("AdditionX")) {
                return operand3 - operand2;
            } else if (questionType.includes("SubtractionX")) {
                return operand3 + operand2;
            } else if (questionType.includes("Addition")) {
                return operand1 + operand2;
            } else if (questionType.includes("Subtraction")) {
                return operand1 - operand2;
            } else if (questionType.includes("Multiplication")) {
                return operand1 * operand2;
            } else if (questionType.includes("Division")) {
                return operand1 / operand2;
            }
        }

        /* Local Storage Mechanism */
        function resetApp() {
            localStorage.clear();
            //location.reload();
            contentBelowReset.classList.add('hidden');
settingsButton.click();
        }

        function fetchQuestion(key, val) {
            if (!isRandomValueExpired(key)) {
                var storedValue = localStorage.getItem(key);
                return storedValue;
            } else {
                storeRandomValue(key, val);
                return val;
            }
        }

        function storeRandomValue(key, val) {
            localStorage.setItem(key, val);
        }

        function isRandomValueExpired(key) {
            var expirationDate = localStorage.getItem('expirationDate');
            if (expirationDate) {
                return new Date().getTime() > parseInt(expirationDate);
            }
            return true;
        }

        function setExpired() {
            var expirationDate = new Date();
            expirationDate.setDate(expirationDate.getDate() + 1);
            localStorage.setItem('expirationDate', expirationDate.getTime());
        }
    </script>
</body>

</html>
